<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/page.css">
    <title>Document</title>
</head>

<body>
    <section>
        <div class="first">
            <h2>PROGRAM</h2>
            <h4> 
        //Create a Scrollable Readonly Resultset and ask the row number from the user and display that row on the screen.   
           </h4>
<pre>
 import java.sql.*;
import java.util.Scanner;

public class ScrollableResultSetExample {
    public static void main(String[] args) {
        String url = "jdbc:mysql://localhost:3306/testdb"; // your database name
        String user = "root"; // your MySQL username
        String password = "1234"; // your MySQL password

        Connection conn = null;
        Statement stmt = null;
        ResultSet rs = null;
        Scanner sc = new Scanner(System.in);

        try {
            // 1. Load JDBC driver
            Class.forName("com.mysql.cj.jdbc.Driver");
            System.out.println("Driver Loaded Successfully!");

            // 2. Establish connection
            conn = DriverManager.getConnection(url, user, password);
            System.out.println("âœ… Connection Established Successfully!");

            // 3. Create a scrollable, read-only Statement
            stmt = conn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);

            // 4. Execute query
            String sql = "SELECT * FROM students";
            rs = stmt.executeQuery(sql);

            // 5. Move to last row to find total number of records
            rs.last();
            int totalRows = rs.getRow();
            System.out.println("\nTotal number of rows in table: " + totalRows);

            // 6. Ask user for a row number
            System.out.print("Enter the row number to view (1 - " + totalRows + "): ");
            int rowNum = sc.nextInt();

            // 7. Validate and move to that row
            if (rowNum >= 1 && rowNum <= totalRows) {
                rs.absolute(rowNum); // move to specific row

                // 8. Retrieve and display the row
                int id = rs.getInt("id");
                String name = rs.getString("name");
                int age = rs.getInt("age");
                String course = rs.getString("course");

                System.out.println("\nðŸŽ“ Student Details (Row " + rowNum + "):");
                System.out.println("--------------------------------------");
                System.out.println("ID     : " + id);
                System.out.println("Name   : " + name);
                System.out.println("Age    : " + age);
                System.out.println("Course : " + course);
                System.out.println("--------------------------------------");
            } else {
                System.out.println("âš ï¸ Invalid row number!");
            }

        } catch (ClassNotFoundException e) {
            System.out.println("âŒ MySQL JDBC Driver not found!");
            e.printStackTrace();
        } catch (SQLException e) {
            System.out.println("âŒ Database operation failed!");
            e.printStackTrace();
        } finally {
            // 9. Close resources
            try {
                if (rs != null) rs.close();
                if (stmt != null) stmt.close();
                if (conn != null) conn.close();
                System.out.println("ðŸ”’ Connection Closed.");
            } catch (SQLException e) {
                e.printStackTrace();
            }
            sc.close();
        }
    }
}                
           
</pre>
        </div>
        <div>
           <h2>OUTPUT</h2>
<pre>
  Driver Loaded Successfully!
âœ… Connection Established Successfully!

Total number of rows in table: 3
Enter the row number to view (1 - 3): 2

ðŸŽ“ Student Details (Row 2):
--------------------------------------
ID     : 2
Name   : Sneha
Age    : 22
Course : Data Science
--------------------------------------
ðŸ”’ Connection Closed.

MySQL Table Example
| id | name  | age | course           |
| -- | ----- | --- | ---------------- |
| 1  | Rahul | 21  | Computer Science |
| 2  | Sneha | 22  | Data Science     |
| 3  | Arjun | 23  | AI and ML        |


</pre>

        </div>
    </section>
</body>

</html>