<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/page.css">
    <title>Document</title>
</head>

<body>
    <section>
        <div class="first">
            <h2>PROGRAM</h2>
            <h4> 
        //Create a Java Program to show, insert, update, delete of the table  
           </h4>
<pre>
import java.sql.*;
import java.util.Scanner;

public class PreparedStatementCRUD {
    public static void main(String[] args) {
        String url = "jdbc:mysql://localhost:3306/testdb"; // your DB name
        String user = "root"; // your MySQL username
        String password = "1234"; // your MySQL password

        Connection conn = null;
        Scanner sc = new Scanner(System.in);

        try {
            // 1. Load JDBC Driver
            Class.forName("com.mysql.cj.jdbc.Driver");
            System.out.println("Driver Loaded Successfully!");

            // 2. Establish Database Connection
            conn = DriverManager.getConnection(url, user, password);
            System.out.println("âœ… Connection Established Successfully!");

            int choice;
            do {
                // Menu
                System.out.println("\n===== STUDENT MANAGEMENT MENU =====");
                System.out.println("1. Show All Students");
                System.out.println("2. Insert New Student");
                System.out.println("3. Update Existing Student");
                System.out.println("4. Delete Student");
                System.out.println("5. Exit");
                System.out.print("Enter your choice: ");
                choice = sc.nextInt();

                switch (choice) {
                    case 1:
                        showStudents(conn);
                        break;

                    case 2:
                        insertStudent(conn, sc);
                        break;

                    case 3:
                        updateStudent(conn, sc);
                        break;

                    case 4:
                        deleteStudent(conn, sc);
                        break;

                    case 5:
                        System.out.println("ğŸ‘‹ Exiting the program...");
                        break;

                    default:
                        System.out.println("âŒ Invalid choice! Please try again.");
                }
            } while (choice != 5);

        } catch (ClassNotFoundException e) {
            System.out.println("âŒ MySQL JDBC Driver not found!");
            e.printStackTrace();
        } catch (SQLException e) {
            System.out.println("âŒ Database operation failed!");
            e.printStackTrace();
        } finally {
            // 3. Close Connection
            try {
                if (conn != null) conn.close();
                sc.close();
                System.out.println("ğŸ”’ Connection Closed.");
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
    }

    // =========================
    // SHOW ALL STUDENTS
    // =========================
    public static void showStudents(Connection conn) throws SQLException {
        String sql = "SELECT * FROM students";
        PreparedStatement pstmt = conn.prepareStatement(sql);
        ResultSet rs = pstmt.executeQuery();

        System.out.println("\nğŸ“ Student Records:");
        System.out.println("-------------------------------------------");
        System.out.printf("%-5s %-15s %-5s %-20s\n", "ID", "Name", "Age", "Course");
        System.out.println("-------------------------------------------");

        boolean hasRecords = false;
        while (rs.next()) {
            hasRecords = true;
            int id = rs.getInt("id");
            String name = rs.getString("name");
            int age = rs.getInt("age");
            String course = rs.getString("course");

            System.out.printf("%-5d %-15s %-5d %-20s\n", id, name, age, course);
        }

        if (!hasRecords) {
            System.out.println("âš ï¸ No records found!");
        }

        rs.close();
        pstmt.close();
    }

    // =========================
    // INSERT NEW STUDENT
    // =========================
    public static void insertStudent(Connection conn, Scanner sc) throws SQLException {
        String sql = "INSERT INTO students (name, age, course) VALUES (?, ?, ?)";
        PreparedStatement pstmt = conn.prepareStatement(sql);

        sc.nextLine(); // consume leftover newline
        System.out.print("Enter Name: ");
        String name = sc.nextLine();

        System.out.print("Enter Age: ");
        int age = sc.nextInt();

        sc.nextLine();
        System.out.print("Enter Course: ");
        String course = sc.nextLine();

        pstmt.setString(1, name);
        pstmt.setInt(2, age);
        pstmt.setString(3, course);

        int rows = pstmt.executeUpdate();
        if (rows > 0) {
            System.out.println("ğŸ‰ Student inserted successfully!");
        }

        pstmt.close();
    }

    // =========================
    // UPDATE EXISTING STUDENT
    // =========================
    public static void updateStudent(Connection conn, Scanner sc) throws SQLException {
        String sql = "UPDATE students SET name = ?, age = ?, course = ? WHERE id = ?";
        PreparedStatement pstmt = conn.prepareStatement(sql);

        System.out.print("Enter ID of student to update: ");
        int id = sc.nextInt();

        sc.nextLine();
        System.out.print("Enter New Name: ");
        String name = sc.nextLine();

        System.out.print("Enter New Age: ");
        int age = sc.nextInt();

        sc.nextLine();
        System.out.print("Enter New Course: ");
        String course = sc.nextLine();

        pstmt.setString(1, name);
        pstmt.setInt(2, age);
        pstmt.setString(3, course);
        pstmt.setInt(4, id);

        int rows = pstmt.executeUpdate();
        if (rows > 0) {
            System.out.println("âœ… Student updated successfully!");
        } else {
            System.out.println("âš ï¸ No student found with ID " + id);
        }

        pstmt.close();
    }

    // =========================
    // DELETE STUDENT
    // =========================
    public static void deleteStudent(Connection conn, Scanner sc) throws SQLException {
        String sql = "DELETE FROM students WHERE id = ?";
        PreparedStatement pstmt = conn.prepareStatement(sql);

        System.out.print("Enter ID of student to delete: ");
        int id = sc.nextInt();

        pstmt.setInt(1, id);

        int rows = pstmt.executeUpdate();
        if (rows > 0) {
            System.out.println("ğŸ—‘ï¸ Student deleted successfully!");
        } else {
            System.out.println("âš ï¸ No student found with ID " + id);
        }

        pstmt.close();
    }
}       
           
</pre>
        </div>
        <div>
           <h2>OUTPUT</h2>
<pre>
  Driver Loaded Successfully!
âœ… Connection Established Successfully!

===== STUDENT MANAGEMENT MENU =====
1. Show All Students
2. Insert New Student
3. Update Existing Student
4. Delete Student
5. Exit
Enter your choice: 2
Enter Name: Anuradha
Enter Age: 22
Enter Course: AI and ML
ğŸ‰ Student inserted successfully!

===== STUDENT MANAGEMENT MENU =====
1. Show All Students
2. Insert New Student
3. Update Existing Student
4. Delete Student
5. Exit
Enter your choice: 1

ğŸ“ Student Records:
-------------------------------------------
ID    Name            Age   Course
-------------------------------------------
1     Anuradha        22    AI and ML
-------------------------------------------
 

</pre>

        </div>
    </section>
</body>

</html>